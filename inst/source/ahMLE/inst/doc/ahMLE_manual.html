<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>ahMLE_manual</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">ahMLE_manual</h1>



<div id="an-r-package-for-fitting-the-additive-hazards-model-with-maximum-likelihood-method." class="section level3">
<h3>An R package for fitting the additive hazards model with maximum likelihood method.</h3>
<div id="what-does-the-package-do" class="section level4">
<h4>What does the package do?</h4>
<p>This R package implements several approaches to fitting the additive hazards model. Besides the traditional Aalen’s method, this package also offers the maximum likelihood methods to fit the model.</p>
</div>
<div id="how-does-it-work" class="section level4">
<h4>How does it work?</h4>
<p>Given the survival variable (survival times and censors) and corresponding indpendent variables, the package offers the function <code>ah</code> which fits the coefficients of the independent variables as a step funtion of time by the choosing method.</p>
<p>For details, see: <a href="https://arxiv.org/abs/2004.06156">Maximum likelihood estimation in the additive hazards model(2021)</a>.</p>
</div>
<div id="attentions-for-the-maximum-likelihood-method" class="section level4">
<h4>Attentions for the maximum likelihood method</h4>
<p>By default, the package do not assume the range of the independent varaibles. However, for the maximum likelihood method, it will automatically take the maximum value and minimum value in the data as the range of the independent variable. If you do not want this setting – for example, you already know the ranges of the varialbes – please rearange the value of indpendent variables between <span class="math inline">\([0,1]\)</span> by linear transformation and put the argument <code>scale</code> to be FALSE. You can calculate the true coefficients of the original data by the inverse of the former linear transformation manually.</p>
<p>When you use the maximum likelihood method with the default domain (the full domain which assures all hazard to be positive), we recommand you to use the optimial method given by the parameter <code>ml_opt</code>, which is also the default method. If you want to input your own domain matrix, the descending method given by the parameter <code>ml_desc</code> is recommanded. In this case, the comsuming time is very sensitive to the number of rows of the domain matrix. If you have very large number of domains (say more than <span class="math inline">\(100\)</span>), it will comsume quite a lot of time.</p>
</div>
</div>
<div id="installing-the-package" class="section level2">
<h2>1. Installing the package</h2>
<p><code>ahMLE</code> is available on <a href="https://cran.r-project.org/package=ahMLE">CRAN</a> and can be installed as follows in an R session:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;ahMLE&quot;</span>)</span></code></pre></div>
<p>Once installed, the package can be loaded in a given R session using:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ahMLE)</span></code></pre></div>
</div>
<div id="running-an-analysis" class="section level2">
<h2>2. Running an analysis</h2>
<p>We apply the method to the data from a clinical trial with 195 patients with carcinoma of the oropharynx by the Radiation Therapy Oncology Group in the United States. Patients were randomised into two treatment groups (“standard” and “experimental” treatment), and survival times were measured in days from diagnosis. Seven covariates were included in the data: Sex, Treatment, Grade, Age, Condition, T-stage and N-stage. The data is originally stored in the package <code>invGauss</code>(which is unforuntately out of update).</p>
<p>In our analysis, we take all the covariates as continuous. We re-scale them to <span class="math inline">\([0,1]\)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(survival)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(invGauss)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ahMLE)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(d.oropha.rec)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>SData <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">time =</span> d.oropha.rec<span class="sc">$</span>time, </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">constant =</span> <span class="dv">1</span>,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sex =</span> d.oropha.rec<span class="sc">$</span>sex, </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">treatm =</span> d.oropha.rec<span class="sc">$</span>treatm, </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">grade =</span> d.oropha.rec<span class="sc">$</span>grade, </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">age =</span> d.oropha.rec<span class="sc">$</span>age, </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">cond =</span> d.oropha.rec<span class="sc">$</span>cond, </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tstage =</span> d.oropha.rec<span class="sc">$</span>tstage, </span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nstage =</span> d.oropha.rec<span class="sc">$</span>nstage,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">event =</span> d.oropha.rec<span class="sc">$</span>status)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Data rescaled</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>SData<span class="sc">$</span>sex <span class="ot">=</span> SData<span class="sc">$</span>sex <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>SData<span class="sc">$</span>treatm <span class="ot">=</span> SData<span class="sc">$</span>treatm <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>SData<span class="sc">$</span>grade <span class="ot">=</span> SData<span class="sc">$</span>grade <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>SData<span class="sc">$</span>age <span class="ot">=</span> (SData<span class="sc">$</span>age <span class="sc">-</span><span class="dv">60</span>)<span class="sc">/</span><span class="dv">10</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>SData<span class="sc">$</span>cond <span class="ot">=</span> SData<span class="sc">$</span>cond <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>SData<span class="sc">$</span>tstage <span class="ot">=</span> SData<span class="sc">$</span>tstage <span class="sc">-</span> <span class="dv">1</span></span></code></pre></div>
<p>With the data rescaled, we can fit the data with two methods, the Aalen’s OLS method and the maximum likelihood method.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>formula_input <span class="ot">=</span> <span class="fu">Surv</span>(<span class="at">time=</span> time, <span class="at">event =</span> event) <span class="sc">~</span> sex <span class="sc">+</span> treatm <span class="sc">+</span>grade <span class="sc">+</span> age <span class="sc">+</span>cond <span class="sc">+</span> tstage <span class="sc">+</span> nstage</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Use Aalen&#39;s OLS method to compute the cumulative beta</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>beta_aalen <span class="ot">=</span> <span class="fu">ah</span>(formula_input, <span class="at">data =</span> SData, <span class="at">method =</span> <span class="st">&quot;aalen&quot;</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>Cbeta_aalen <span class="ot">=</span> beta_aalen<span class="sc">$</span>cumbeta</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Use (default) maximum likelihood method to compute the cumulative beta</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>beta_mle<span class="ot">=</span> <span class="fu">ah</span>(formula_input, <span class="at">data =</span> SData, <span class="at">progbar =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>Cbeta_mle <span class="ot">=</span> beta_mle<span class="sc">$</span>cumbeta</span></code></pre></div>
</div>
<div id="plot" class="section level2">
<h2>3. Plot</h2>
<p>We illustrate the cumulative beta estimated by two methods for the additive hazards model.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>old.par <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">no.readonly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">2</span>))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>time_grid <span class="ot">=</span> beta_aalen<span class="sc">$</span>cumbeta[,<span class="dv">1</span>]</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time_grid,Cbeta_mle[,<span class="dv">2</span>],<span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col=</span><span class="fu">colors</span>()[<span class="dv">258</span>], <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>,<span class="fl">1.1</span>),  <span class="at">ylab =</span> <span class="st">&quot;Cumulative beta&quot;</span>,<span class="at">xlab =</span> <span class="st">&quot;Days from diagnosis&quot;</span>, <span class="at">cex.lab=</span><span class="dv">1</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(time_grid,Cbeta_aalen[,<span class="dv">2</span>], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty =</span> <span class="dv">5</span>, <span class="at">lwd =</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;MLE&quot;</span>,<span class="st">&quot;OLS&quot;</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="fu">colors</span>()[<span class="dv">258</span>],<span class="st">&quot;red&quot;</span>),<span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>), <span class="at">cex=</span><span class="dv">1</span>,<span class="at">lwd =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(old.par)</span></code></pre></div>
</div>
<div id="acknowledgement" class="section level2">
<h2>4. Acknowledgement</h2>
<p>The project is sponsored by the Leiden University Fund / Hakkenberg <span class="math inline">\(\alpha\)</span> <span class="math inline">\(\beta\)</span> <span class="math inline">\(\gamma\)</span>-integratie Fonds, www.luf.nl. We would like to thank and acknowledge their support.</p>
<p>We acknowledge the authors of the package <code>invGauss</code> for importing their clinical data of carcinoma of the oropharynx.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
