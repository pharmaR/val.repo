<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Estimating the intensive and extensive margin of trade</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Estimating the intensive and extensive
margin of trade</h1>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>In econometrics, fixed effects models are popular to control for
unobserved heterogeneity in data sets with a panel structure. In
non-linear models this is usually done by including a dummy variable for
each level of a fixed effects category. This approach can quickly become
infeasible if the number of levels and/or fixed effects categories
increases (either due to memory or time limitations).</p>
<p>Two examples of this limitation can be found in the literature on
international trade. Firstly, when it comes to estimating the
determinants of trade volumes (intensive margin) or secondly, when it
comes to the export decisions (extensive margin). In order to
demonstrate the functionality and capabilities of <code>alpaca</code>,
we replicate parts of <span class="citation">Larch et al. (2019)</span>
as an example for the intensive margin and extend it to the extensive
margin. Our example is based on the panel data set of 2,973,168
bilateral trade flows used by <span class="citation">Glick and Rose
(2016)</span>. For our estimations we specify a three-way error
component with 56,608 levels.</p>
</div>
<div id="data-preparation" class="section level2">
<h2>Data preparation</h2>
<p>The data set is available either from <a href="http://faculty.haas.berkeley.edu/arose/RecRes.htm">Andrew Rose’s
website</a> or from <a href="https://www.sciencedirect.com/science/article/pii/S0014292116300630#ec0005">sciencedirect</a>.
We use the same variable names as <span class="citation">Glick and Rose
(2016)</span> such that we are able to compare our summary statistics
with the ones provided in their <em>Stata</em> log-files.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Required packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(alpaca)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Import the data set</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>cudata <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">&quot;dataaxj1.dta&quot;</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">setDT</span>(cudata)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset relevant variables</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>var.nms <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;exp1to2&quot;</span>, <span class="st">&quot;custrict11&quot;</span>, <span class="st">&quot;ldist&quot;</span>, <span class="st">&quot;comlang&quot;</span>, <span class="st">&quot;border&quot;</span>, <span class="st">&quot;regional&quot;</span>,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;comcol&quot;</span>, <span class="st">&quot;curcol&quot;</span>, <span class="st">&quot;colony&quot;</span>, <span class="st">&quot;comctry&quot;</span>, <span class="st">&quot;cuwoemu&quot;</span>, <span class="st">&quot;emu&quot;</span>, <span class="st">&quot;cuc&quot;</span>,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;cty1&quot;</span>, <span class="st">&quot;cty2&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;pairid&quot;</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>cudata <span class="ot">&lt;-</span> cudata[, var.nms, with <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate identifiers required for structural gravity</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>cudata[, pairid <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(pairid)]</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>cudata[, exp.time <span class="sc">:</span><span class="er">=</span> <span class="fu">interaction</span>(cty1, year)]</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>cudata[, imp.time <span class="sc">:</span><span class="er">=</span> <span class="fu">interaction</span>(cty2, year)]</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate dummies for disaggregated currency unions</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>cudata[, cuau <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(cuc <span class="sc">==</span> <span class="st">&quot;au&quot;</span>)]</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>cudata[, cube <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(cuc <span class="sc">==</span> <span class="st">&quot;be&quot;</span>)]</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>cudata[, cuca <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(cuc <span class="sc">==</span> <span class="st">&quot;ca&quot;</span>)]</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>cudata[, cucf <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(cuc <span class="sc">==</span> <span class="st">&quot;cf&quot;</span>)]</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>cudata[, cucp <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(cuc <span class="sc">==</span> <span class="st">&quot;cp&quot;</span>)]</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>cudata[, cudk <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(cuc <span class="sc">==</span> <span class="st">&quot;dk&quot;</span>)]</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>cudata[, cuea <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(cuc <span class="sc">==</span> <span class="st">&quot;ea&quot;</span>)]</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>cudata[, cuec <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(cuc <span class="sc">==</span> <span class="st">&quot;ec&quot;</span>)]</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>cudata[, cuem <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(cuc <span class="sc">==</span> <span class="st">&quot;em&quot;</span>)]</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>cudata[, cufr <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(cuc <span class="sc">==</span> <span class="st">&quot;fr&quot;</span>)]</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>cudata[, cugb <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(cuc <span class="sc">==</span> <span class="st">&quot;gb&quot;</span>)]</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>cudata[, cuin <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(cuc <span class="sc">==</span> <span class="st">&quot;in&quot;</span>)]</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>cudata[, cuma <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(cuc <span class="sc">==</span> <span class="st">&quot;ma&quot;</span>)]</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>cudata[, cuml <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(cuc <span class="sc">==</span> <span class="st">&quot;ml&quot;</span>)]</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>cudata[, cunc <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(cuc <span class="sc">==</span> <span class="st">&quot;nc&quot;</span>)]</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>cudata[, cunz <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(cuc <span class="sc">==</span> <span class="st">&quot;nz&quot;</span>)]</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>cudata[, cupk <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(cuc <span class="sc">==</span> <span class="st">&quot;pk&quot;</span>)]</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>cudata[, cupt <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(cuc <span class="sc">==</span> <span class="st">&quot;pt&quot;</span>)]</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>cudata[, cusa <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(cuc <span class="sc">==</span> <span class="st">&quot;sa&quot;</span>)]</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>cudata[, cusp <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(cuc <span class="sc">==</span> <span class="st">&quot;sp&quot;</span>)]</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>cudata[, cuua <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(cuc <span class="sc">==</span> <span class="st">&quot;ua&quot;</span>)]</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>cudata[, cuus <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(cuc <span class="sc">==</span> <span class="st">&quot;us&quot;</span>)]</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>cudata[, cuwa <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(cuc <span class="sc">==</span> <span class="st">&quot;wa&quot;</span>)]</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>cudata[, cuwoo <span class="sc">:</span><span class="er">=</span> custrict11]</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>cudata[cuc <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;em&quot;</span>, <span class="st">&quot;au&quot;</span>, <span class="st">&quot;cf&quot;</span>, <span class="st">&quot;ec&quot;</span>, <span class="st">&quot;fr&quot;</span>, <span class="st">&quot;gb&quot;</span>, <span class="st">&quot;in&quot;</span>, <span class="st">&quot;us&quot;</span>), cuwoo <span class="sc">:</span><span class="er">=</span> <span class="dv">0</span>]</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Set missing trade flows to zero</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>cudata[<span class="fu">is.na</span>(exp1to2), exp1to2 <span class="sc">:</span><span class="er">=</span> <span class="dv">0</span>]</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-scale trade flows</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>cudata[, exp1to2 <span class="sc">:</span><span class="er">=</span> exp1to2 <span class="sc">/</span> <span class="dv">1000</span>]</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct binary and lagged dependent variable for the extensive margin</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>cudata[, trade <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(exp1to2 <span class="sc">&gt;</span> <span class="dv">0</span>)]</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>cudata[, ltrade <span class="sc">:</span><span class="er">=</span> <span class="fu">shift</span>(trade), by <span class="ot">=</span> pairid]</span></code></pre></div>
</div>
<div id="estimating-the-intensive-margin-of-trade" class="section level2">
<h2>Estimating the intensive margin of trade</h2>
<p>After preparing the data, we show how to replicate column 3 of table
2 in <span class="citation">Larch et al. (2019)</span>. In addition to
coefficients and robust standard errors, the authors also report
standard errors clustered by exporter, importer, and time.</p>
<p>If we want <code>feglm()</code> to report standard errors that are
clustered by variables, which are not already part of the model itself,
we have to additionally provide them using the third part of the
<code>formula</code> interface. In this example, we have to additionally
add identifiers for exporters (<code>cty1</code>), importers
(<code>cty2</code>), and time (<code>year</code>).</p>
<p>First we report robust standard errors indicated by the option
<code>&quot;sandwich&quot;</code> in <code>summary()</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">feglm</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  exp1to2 <span class="sc">~</span> emu <span class="sc">+</span> cuwoo <span class="sc">+</span> cuau <span class="sc">+</span> cucf <span class="sc">+</span> cuec <span class="sc">+</span> cufr <span class="sc">+</span> cugb <span class="sc">+</span> cuin <span class="sc">+</span> cuus <span class="sc">+</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    regional <span class="sc">+</span> curcol <span class="sc">|</span> exp.time <span class="sc">+</span> imp.time <span class="sc">+</span> pairid <span class="sc">|</span> cty1 <span class="sc">+</span> cty2 <span class="sc">+</span> year,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data   =</span> cudata,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">poisson</span>()</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod, <span class="st">&quot;sandwich&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">## poisson - log link</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="do">## exp1to2 ~ emu + cuwoo + cuau + cucf + cuec + cufr + cugb + cuin +</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="do">##     cuus + regional + curcol | exp.time + imp.time + pairid |</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="do">##     cty1 + cty2 + year</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimates:</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="do">##           Estimate Std. error z value Pr(&gt; |z|)</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="do">## emu       0.048895   0.010277   4.758  1.96e-06 ***</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="do">## cuwoo     0.765988   0.053272  14.379   &lt; 2e-16 ***</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="do">## cuau      0.384469   0.118832   3.235   0.00121 **</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="do">## cucf     -0.125608   0.099674  -1.260   0.20760</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="do">## cuec     -0.877318   0.083451 -10.513   &lt; 2e-16 ***</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="do">## cufr      2.095726   0.062952  33.291   &lt; 2e-16 ***</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="do">## cugb      1.059957   0.034680  30.564   &lt; 2e-16 ***</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="do">## cuin      0.169745   0.147029   1.154   0.24830</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="do">## cuus      0.018323   0.021530   0.851   0.39473</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="do">## regional  0.159181   0.008714  18.267   &lt; 2e-16 ***</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="do">## curcol    0.386882   0.046827   8.262   &lt; 2e-16 ***</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="do">## residual deviance= 35830.78,</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="do">## null deviance= 2245707.30,</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="do">## n= 1610165, l= [11227, 11277, 34104]</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="do">## ( 1363003 observation(s) deleted due to perfect classification )</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="do">## Number of Fisher Scoring Iterations: 20</span></span></code></pre></div>
<p>We observe that roughly 1.4 million observations do not contribute to
the identification of the structural parameters and we end up with
roughly 1.6 million observations and 57,000 fixed effects.</p>
<p>Replicating the clustered standard errors is straightforward. We
simply have to change the type to <code>&quot;clustered&quot;</code> and provide
<code>summary</code> with the requested cluster dimensions.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod, <span class="at">type =</span> <span class="st">&quot;clustered&quot;</span>, <span class="at">cluster =</span> <span class="sc">~</span> cty1 <span class="sc">+</span> cty2 <span class="sc">+</span> year)</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">## poisson - log link</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="do">## exp1to2 ~ emu + cuwoo + cuau + cucf + cuec + cufr + cugb + cuin + </span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="do">##     cuus + regional + curcol | exp.time + imp.time + pairid | </span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="do">##     cty1 + cty2 + year</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimates:</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="do">##          Estimate Std. error z value Pr(&gt; |z|)    </span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="do">## emu       0.04890    0.09455   0.517   0.60507    </span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="do">## cuwoo     0.76599    0.24933   3.072   0.00213 ** </span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="do">## cuau      0.38447    0.22355   1.720   0.08546 .  </span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="do">## cucf     -0.12561    0.35221  -0.357   0.72137    </span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="do">## cuec     -0.87732    0.29493  -2.975   0.00293 ** </span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="do">## cufr      2.09573    0.30625   6.843  7.75e-12 ***</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="do">## cugb      1.05996    0.23766   4.460  8.19e-06 ***</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="do">## cuin      0.16974    0.30090   0.564   0.57267    </span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="do">## cuus      0.01832    0.05092   0.360   0.71898    </span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="do">## regional  0.15918    0.07588   2.098   0.03593 *  </span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="do">## curcol    0.38688    0.15509   2.495   0.01261 *  </span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="do">## residual deviance= 35830.78,</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="do">## null deviance= 2245707.30,</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="do">## n= 1610165, l= [11227, 11277, 34104]</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="do">## ( 1363003 observation(s) deleted due to perfect classification )</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="do">## Number of Fisher Scoring Iterations: 20 </span></span></code></pre></div>
</div>
<div id="testing-linear-restrictions" class="section level2">
<h2>Testing linear restrictions</h2>
<p>Our package is also compatible with <code>linearHypothesis()</code>
of the <code>car</code> package. In the next example we show how to test
if all currency union effects except being in the EMU are jointly
different from zero using a Wald test based on a clustered covariance
matrix.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>h0_cus <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;cuwoo&quot;</span>, <span class="st">&quot;cuau&quot;</span>, <span class="st">&quot;cucf&quot;</span>, <span class="st">&quot;cuec&quot;</span>, <span class="st">&quot;cufr&quot;</span>, <span class="st">&quot;cugb&quot;</span>, <span class="st">&quot;cuin&quot;</span>, <span class="st">&quot;cuus&quot;</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  mod, h0_cus,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">vcov. =</span> <span class="fu">vcov</span>(mod, <span class="st">&quot;clustered&quot;</span>, <span class="at">cluster =</span> <span class="sc">~</span> cty1 <span class="sc">+</span> cty2 <span class="sc">+</span> year)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Linear hypothesis test</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Hypothesis:</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="do">## cuwoo = 0</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="do">## cuau = 0</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="do">## cucf = 0</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="do">## cuec = 0</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="do">## cufr = 0</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="do">## cugb = 0</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="do">## cuin = 0</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="do">## cuus = 0</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Model 1: restricted model</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Model 2: exp1to2 ~ emu + cuwoo + cuau + cucf + cuec + cufr + cugb + cuin + </span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="do">##     cuus + regional + curcol | exp.time + imp.time + pairid | </span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="do">##     cty1 + cty2 + year</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="do">##   Df  Chisq Pr(&gt;Chisq)    </span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="do">## 1                         </span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="do">## 2  8 96.772  &lt; 2.2e-16 ***</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span></code></pre></div>
</div>
<div id="estimating-the-extensive-margin-of-trade" class="section level2">
<h2>Estimating the extensive margin of trade</h2>
<p>Now we turn to the estimation of the extensive margin. First we
estimate a static logit model.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>mods <span class="ot">&lt;-</span> <span class="fu">feglm</span>(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  trade <span class="sc">~</span> cuwoemu <span class="sc">+</span> emu <span class="sc">+</span> regional <span class="sc">|</span> exp.time <span class="sc">+</span> imp.time <span class="sc">+</span> pairid,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data   =</span> cudata,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="st">&quot;logit&quot;</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mods)</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">## binomial - logit link</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="do">## trade ~ cuwoemu + emu + regional | exp.time + imp.time + pairid</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimates:</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="do">##          Estimate Std. error z value Pr(&gt; |z|)    </span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="do">## cuwoemu   0.41037    0.05103   8.041  8.89e-16 ***</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="do">## emu       0.55108    0.23080   2.388   0.01696 *  </span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="do">## regional  0.10193    0.03271   3.116   0.00183 ** </span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="do">## residual deviance= 674579.11,</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="do">## null deviance= 1917254.65,</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="do">## n= 1384892, l= [11150, 11218, 29391]</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="do">## ( 1588276 observation(s) deleted due to perfect classification )</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Number of Fisher Scoring Iterations: 11 </span></span></code></pre></div>
<p>To mitigate the incidental parameters problem (see <span class="citation">Neyman and Scott (1948)</span>) we apply the bias
correction suggested by <span class="citation">Hinz, Stammann, and
Wanner (2020)</span>. Note that the argument
<code>panel.structure = &quot;network&quot;</code> is necessary to apply the
appropriate bias correction.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>modsbc <span class="ot">&lt;-</span> <span class="fu">biasCorr</span>(mods, <span class="at">panel.structure =</span> <span class="st">&quot;network&quot;</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modsbc)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">## binomial - logit link</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="do">## trade ~ cuwoemu + emu + regional | exp.time + imp.time + pairid</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimates:</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="do">##          Estimate Std. error z value Pr(&gt; |z|)    </span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="do">## cuwoemu   0.37630    0.05107   7.369  1.72e-13 ***</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="do">## emu       0.47213    0.23056   2.048   0.04058 *  </span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="do">## regional  0.09942    0.03270   3.040   0.00236 ** </span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="do">## residual deviance= 674579.11,</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="do">## null deviance= 1917254.65,</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="do">## n= 1384892, l= [11150, 11218, 29391]</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="do">## ( 1588276 observation(s) deleted due to perfect classification )</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Number of Fisher Scoring Iterations: 11</span></span></code></pre></div>
<p>Because coefficients itself are not very meaningful, researchers are
usually interested in so called partial effects (also known as marginal
or ceteris paribus effects). A commonly used statistic is the average
partial effect. <code>alpaca</code> offers a post-estimation routine to
estimate average partial effects and their corresponding standard
errors. In the following the bias-corrected average partial effects are
computed.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>apesbc <span class="ot">&lt;-</span> <span class="fu">getAPEs</span>(modsbc)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(apesbc)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimates:</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="do">##          Estimate Std. error z value Pr(&gt; |z|)    </span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="do">## cuwoemu  0.015554   0.001957   7.946  1.92e-15 ***</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="do">## emu      0.019567   0.008212   2.383  0.017185 *  </span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="do">## regional 0.004079   0.001189   3.429  0.000605 ***</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span></code></pre></div>
<p><span class="citation">Hinz, Stammann, and Wanner (2020)</span>
propose to estimate the extensive margin using a dynamic specification,
where the lagged dependent variable is added to the list of explanatory
variables. Again, a bias correction is necessary. Contrary to the one
for static models with strictly exogenous regressors, we need to
additionally provide a bandwidth parameter (<code>L</code>) that is
required for the estimation of spectral densities (see <span class="citation">Hahn and Kuersteiner (2011)</span>). <span class="citation">Fernández-Val and Weidner (2016)</span> suggest to do a
sensitivity analysis and try different values for <code>L</code> but not
larger than four. Note that in this case the order of factors to be
concentrated out, specified in the second part of the formula, is
important (importer-/exporter-time identifiers first and pair identifier
last).</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>modd <span class="ot">&lt;-</span> <span class="fu">feglm</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  trade <span class="sc">~</span> ltrade <span class="sc">+</span> cuwoemu <span class="sc">+</span> emu <span class="sc">+</span> regional <span class="sc">|</span> exp.time <span class="sc">+</span> imp.time <span class="sc">+</span> pairid,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data   =</span> cudata,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="st">&quot;logit&quot;</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>moddbc <span class="ot">&lt;-</span> <span class="fu">biasCorr</span>(modd, <span class="at">L =</span> <span class="dv">4</span>, <span class="at">panel.structure =</span> <span class="st">&quot;network&quot;</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(moddbc)</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">## binomial - logit link</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="do">## trade ~ ltrade + cuwoemu + emu + regional | exp.time + imp.time + </span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="do">##     pairid</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimates:</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="do">##          Estimate Std. error z value Pr(&gt; |z|)    </span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="do">## ltrade   2.166103   0.008003 270.663   &lt; 2e-16 ***</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="do">## cuwoemu  0.268477   0.054482   4.928  8.31e-07 ***</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="do">## emu      0.312551   0.254091   1.230    0.2187    </span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="do">## regional 0.063077   0.035328   1.785    0.0742 .  </span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="do">## residual deviance= 602773.13,</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="do">## null deviance= 1899840.83,</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="do">## n= 1372471, l= [11054, 11116, 29299]</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="do">## ( 45048 observation(s) deleted due to missingness )</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="do">## ( 1555649 observation(s) deleted due to perfect classification )</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Number of Fisher Scoring Iterations: 11 </span></span></code></pre></div>
<p>Again we compute bias-corrected average partial effects to get
meaningful quantities.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>apedbc <span class="ot">&lt;-</span> <span class="fu">getAPEs</span>(moddbc)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(apedbc)</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimates:</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="do">##           Estimate Std. error z value Pr(&gt; |z|)    </span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="do">## ltrade   0.1213377  0.0004681 259.231   &lt; 2e-16 ***</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="do">## cuwoemu  0.0100223  0.0016486   6.079  1.21e-09 ***</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="do">## emu      0.0116944  0.0078456   1.491    0.1361    </span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="do">## regional 0.0023338  0.0010544   2.213    0.0269 *  </span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span></code></pre></div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="unnumbered">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-fw16" class="csl-entry">
Fernández-Val, Iván, and Martin Weidner. 2016. <span>“Individual and
Time Effects in Nonlinear Panel Models with Large n, t.”</span>
<em>Journal of Econometrics</em> 192 (1): 291–312.
</div>
<div id="ref-gr16" class="csl-entry">
Glick, Reuven, and Andrew K. Rose. 2016. <span>“Currency Unions and
Trade: A Post-EMU Reassessment.”</span> <em>European Economic
Review</em> 87: 78–91.
</div>
<div id="ref-hk11" class="csl-entry">
Hahn, Jinyong, and Guido Kuersteiner. 2011. <span>“Bias Reduction for
Dynamic Nonlinear Panel Models with Fixed Effects.”</span>
<em>Econometric Theory</em> 27 (6): 1152–91.
</div>
<div id="ref-hsw20" class="csl-entry">
Hinz, Julian, Amrei Stammann, and Joschka Wanner. 2020. <span>“State
Dependence and Unobserved Heterogeneity in the Extensive Margin of
Trade.”</span> <em>ArXiv e-Prints</em>.
</div>
<div id="ref-lwyz19" class="csl-entry">
Larch, Mario, Joschka Wanner, Yoto V. Yotov, and Thomas Zylkin. 2019.
<span>“Currency Unions and Trade: A PPML Re-Assessment with
High-Dimensional Fixed Effects.”</span> <em>Oxford Bulletin of Economics
and Statistics</em> 81 (3): 487–510.
</div>
<div id="ref-ns48" class="csl-entry">
Neyman, Jerzy, and Elizabeth L. Scott. 1948. <span>“Consistent Estimates
Based on Partially Consistent Observations.”</span>
<em>Econometrica</em> 16 (1): 1–32.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
