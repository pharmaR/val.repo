<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Smoothing Methods</title>
<style type="text/css">
/**
 * Prism.s theme ported from highlight.js's xcode style
 */
pre code {
  padding: 1em;
}
.token.comment {
  color: #007400;
}
.token.punctuation {
  color: #999;
}
.token.tag,
.token.selector {
  color: #aa0d91;
}
.token.boolean,
.token.number,
.token.constant,
.token.symbol {
  color: #1c00cf;
}
.token.property,
.token.attr-name,
.token.string,
.token.char,
.token.builtin {
  color: #c41a16;
}
.token.inserted {
  background-color: #ccffd8;
}
.token.deleted {
  background-color: #ffebe9;
}
.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
  color: #9a6e3a;
}
.token.atrule,
.token.attr-value,
.token.keyword {
  color: #836c28;
}
.token.function,
.token.class-name {
  color: #DD4A68;
}
.token.regex,
.token.important,
.token.variable {
  color: #5c2699;
}
.token.important,
.token.bold {
  font-weight: bold;
}
.token.italic {
  font-style: italic;
}
</style>
<style type="text/css">
body {
  font-family: sans-serif;
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 1.5;
  box-sizing: border-box;
}
body, .footnotes, code { font-size: .9em; }
li li { font-size: .95em; }
*, *:before, *:after {
  box-sizing: inherit;
}
pre, img { max-width: 100%; }
pre, pre:hover {
  white-space: pre-wrap;
  word-break: break-all;
}
pre code {
  display: block;
  overflow-x: auto;
}
code { font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace; }
:not(pre) > code, code[class] { background-color: #F8F8F8; }
code.language-undefined, pre > code:not([class]) {
  background-color: inherit;
  border: 1px solid #eee;
}
table {
  margin: auto;
  border-top: 1px solid #666;
}
table thead th { border-bottom: 1px solid #ddd; }
th, td { padding: 5px; }
thead, tfoot, tr:nth-child(even) { background: #eee; }
blockquote {
  color: #666;
  margin: 0;
  padding-left: 1em;
  border-left: 0.5em solid #eee;
}
hr, .footnotes::before { border: 1px dashed #ddd; }
.frontmatter { text-align: center; }
#TOC .numbered li { list-style: none; }
#TOC .numbered { padding-left: 0; }
#TOC .numbered ul { padding-left: 1em; }
table, .body h2 { border-bottom: 1px solid #666; }
.body .appendix, .appendix ~ h2 { border-bottom-style: dashed; }
.footnote-ref a::before { content: "["; }
.footnote-ref a::after { content: "]"; }
section.footnotes::before {
  content: "";
  display: block;
  max-width: 20em;
}

@media print {
  body {
    font-size: 12pt;
    max-width: 100%;
  }
  tr, img { page-break-inside: avoid; }
}
@media only screen and (min-width: 992px) {
  pre { white-space: pre; }
}
</style>
</head>
<body>
<div class="frontmatter">
<div class="title"><h1>Smoothing Methods</h1></div>
<div class="author"><h2>N. Frerebeau</h2></div>
<div class="date"><h3>2025-02-25</h3></div>
</div>
<div class="body">
<div id="TOC">
<ul class="numbered">
<li><a href="#rectangular-smoothing"><span class="section-number">1.</span> Rectangular smoothing</a></li>
<li><a href="#triangular-smoothing"><span class="section-number">2.</span> Triangular smoothing</a></li>
<li><a href="#loess-smoothing"><span class="section-number">3.</span> Loess smoothing</a></li>
<li><a href="#savitzky-golay-filter"><span class="section-number">4.</span> Savitzky-Golay filter</a></li>
<li><a href="#whittaker-smoothing"><span class="section-number">5.</span> Whittaker smoothing</a></li>
</ul>
</div>
<pre><code class="language-r">library(alkahest)
</code></pre>
<pre><code class="language-r">## Simulate data
set.seed(12345)
x &lt;- seq(-4, 4, length = 100)
y &lt;- dnorm(x)
z &lt;- y + rnorm(100, mean = 0, sd = 0.01) # Add some noise

## Plot raw data
plot(x, z, type = &quot;l&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;, las = 1)
lines(x, y, type = &quot;l&quot;, lty = 2, col = &quot;red&quot;)
</code></pre>
<p><img src="data:image/png;base64,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" alt="Simulated data." /></p>
<h1 id="rectangular-smoothing"><span class="section-number">1.</span> Rectangular smoothing</h1>
<pre><code class="language-r">unweighted &lt;- smooth_rectangular(x, z, m = 3)

par(mar = c(3, 3, 1, 1) + 0.1, las = 1)
layout(matrix(c(1, 2), nrow = 2, ncol = 1), heights = c(2, 1))

plot(unweighted, type = &quot;l&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;) 
lines(x, y, type = &quot;l&quot;, lty = 2, col = &quot;red&quot;)

plot(x, y - unweighted$y, ylim = c(-0.03, 0.03), type = &quot;l&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;)
abline(h = 0, lty = 2)
</code></pre>
<p><img src="data:image/png;base64,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" alt="Rectangular smoothing." /></p>
<h1 id="triangular-smoothing"><span class="section-number">2.</span> Triangular smoothing</h1>
<pre><code class="language-r">weighted &lt;- smooth_triangular(x, z, m = 5)

par(mar = c(3, 3, 1, 1) + 0.1, las = 1)
layout(matrix(c(1, 2), nrow = 2, ncol = 1), heights = c(2, 1))

plot(weighted, type = &quot;l&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;)
lines(x, y, type = &quot;l&quot;, lty = 2, col = &quot;red&quot;)

plot(x, y - weighted$y, ylim = c(-0.03, 0.03), type = &quot;l&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;)
abline(h = 0, lty = 2)
</code></pre>
<p><img src="data:image/png;base64,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" alt="Triangular smoothing." /></p>
<h1 id="loess-smoothing"><span class="section-number">3.</span> Loess smoothing</h1>
<pre><code class="language-r">loess &lt;- smooth_loess(x, z, span = 0.2)

par(mar = c(3, 3, 1, 1) + 0.1, las = 1)
layout(matrix(c(1, 2), nrow = 2, ncol = 1), heights = c(2, 1))

plot(loess, type = &quot;l&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;)
lines(x, y, type = &quot;l&quot;, lty = 2, col = &quot;red&quot;)

plot(x, y - loess$y, ylim = c(-0.03, 0.03), type = &quot;l&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;)
abline(h = 0, lty = 2)
</code></pre>
<p><img src="data:image/png;base64,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" alt="Loess smoothing." /></p>
<h1 id="savitzky-golay-filter"><span class="section-number">4.</span> Savitzky-Golay filter</h1>
<pre><code class="language-r">savitzky &lt;- smooth_savitzky(x, z, m = 21, p = 2)

par(mar = c(3, 3, 1, 1) + 0.1, las = 1)
layout(matrix(c(1, 2), nrow = 2, ncol = 1), heights = c(2, 1))

plot(savitzky, type = &quot;l&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;)
lines(x, y, type = &quot;l&quot;, lty = 2, col = &quot;red&quot;)

plot(x, y - savitzky$y, ylim = c(-0.03, 0.03), type = &quot;l&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;)
abline(h = 0, lty = 2)
</code></pre>
<p><img src="data:image/png;base64,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" alt="Savitzky–Golay filter." /></p>
<h1 id="whittaker-smoothing"><span class="section-number">5.</span> Whittaker smoothing</h1>
<pre><code class="language-r">whittaker &lt;- smooth_whittaker(x, z, lambda = 1000, d = 3, sparse = TRUE)

par(mar = c(3, 3, 1, 1) + 0.1, las = 1)
layout(matrix(c(1, 2), nrow = 2, ncol = 1), heights = c(2, 1))

plot(whittaker, type = &quot;l&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;)
lines(x, y, type = &quot;l&quot;, lty = 2, col = &quot;red&quot;)

plot(x, y - whittaker$y, ylim = c(-0.03, 0.03), type = &quot;l&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;)
abline(h = 0, lty = 2)
</code></pre>
<p><img src="data:image/png;base64,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" alt="Whittaker smoothing." /></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js" defer></script>
</body>
</html>
